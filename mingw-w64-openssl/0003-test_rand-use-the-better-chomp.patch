From fbb81a899dabd443737e726fde930906fce5f846 Mon Sep 17 00:00:00 2001
From: Johannes Schindelin <johannes.schindelin@gmx.de>
Date: Wed, 25 Oct 2023 17:10:17 +0200
Subject: [PATCH 3/7] test_rand: use the "better chomp"

Following in the footsteps of
https://github.com/openssl/openssl/commit/9ba96fbb2523cb12747c559c704c58bd8f9e7982
(Perl's chop / chomp considered bad, use a regexp instead, 2016-02-11),
let's not use `chomp()` here because it would leave Carriage Returns in
place, making the test fail in the MINGW build on Windows.

Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
---
 test/recipes/05-test_rand.t | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/test/recipes/05-test_rand.t b/test/recipes/05-test_rand.t
index 7462630..02b14ee 100644
--- a/test/recipes/05-test_rand.t
+++ b/test/recipes/05-test_rand.t
@@ -36,17 +36,17 @@ SKIP: {
 
     @randdata = run(app(['openssl', 'rand', '-engine', 'ossltest', '-hex', '16' ]),
                     capture => 1, statusvar => \$success);
-    chomp(@randdata);
+    $_ =~ s|\R+$|| for @randdata;
     ok($success && $randdata[0] eq $expected,
        "rand with ossltest: Check rand output is as expected");
 
     @randdata = run(app(['openssl', 'rand', '-hex', '2K' ]),
                     capture => 1, statusvar => \$success);
-    chomp(@randdata);
+    $_ =~ s|\R+$|| for @randdata;
 
     @randdata = run(app(['openssl', 'rand', '-engine', 'dasync', '-hex', '16' ]),
                     capture => 1, statusvar => \$success);
-    chomp(@randdata);
+    $_ =~ s|\R+$|| for @randdata;
     ok($success && length($randdata[0]) == 32,
        "rand with dasync: Check rand output is of expected length");
 }
